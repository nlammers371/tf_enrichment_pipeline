clear
close all
clc

addpath(genpath('./lib'))

%% set up data
fluo_DELAY_no_zero_4min = [59850.2343750000,86362.9609375000,115824.625000000,125806.789062500,87096.8671875000,133936.250000000,263884.718750000,186703.718750000,212538.968750000,159378.437500000,235611.781250000,239057,112011,148089.421875000,235337.015625000,156513.859375000,361555.093750000,137270.718750000,371904.937500000,134245.421875000,127429.085937500,423291.968750000,259552.656250000,99089.9296875000,277527.500000000,108703.414062500,159380.015625000,203158.968750000,247224.781250000,297360.875000000,279599.937500000,349283.937500000,110271.054687500,308968.156250000,420845.625000000,117869.375000000,193681.234375000,212892.312500000,81363.4453125000,276776.687500000,274061.750000000,465598.750000000,266085.187500000,204780.656250000,118542.921875000,181392.937500000,334102.031250000,272759.562500000,88736.4687500000,199538.375000000,275570.093750000,144470.093750000,216918.109375000,135349.125000000,352738.718750000,257176.281250000,237309.234375000,125783.687500000,126771.343750000,96013.4062500000,158007.500000000,193875.703125000,152252.578125000,199182.562500000,152121.656250000,415773.281250000,142376.718750000,186963.843750000,100922.687500000];
fluo_DELAY_no_zero_5min = [211129.406250000,116020.820312500,125003.593750000,230341.562500000,100140.750000000,77140.0312500000,175568.546875000,162171.453125000,56201.0898437500,479913,151863.109375000,263768.937500000,167376.453125000,159872.187500000,281906.750000000,224442.625000000,361553.625000000,89883.8906250000,103177.125000000,268940.312500000,260713.437500000,316947.625000000,125662.070312500,192206.296875000,487520.625000000,169621.218750000,95762.4921875000,112539.250000000,246072.296875000,235593.171875000,90570.6171875000,518491.093750000,370771.906250000,453199.843750000,133485.296875000,269340.250000000,257426.140625000,54500.6914062500,392733.593750000,135496.015625000,353784.906250000,258006.546875000,326998.156250000,163651.265625000,160171.359375000,102369.828125000,169348.921875000,80384.4375000000,349833.343750000,75713.4140625000,182175.500000000,365405.312500000,65365.8398437500,147891,491926.781250000,324795.593750000,285373.906250000,325855.625000000,48681.1875000000,77486.9687500000,126742.203125000,120484.070312500,174013.468750000,67814.0390625000,229223.281250000,148042.687500000,151776.421875000,164144.562500000,78404.3906250000,116095.703125000,215166.156250000,167604.234375000];
fluo_DELAY_4min = [59850.2343750000,0,86362.9609375000,115824.625000000,125806.789062500,0,0,87096.8671875000,133936.250000000,0,263884.718750000,186703.718750000,0,0,0,212538.968750000,159378.437500000,0,0,235611.781250000,239057,0,112011,148089.421875000,235337.015625000,156513.859375000,0,361555.093750000,137270.718750000,371904.937500000,134245.421875000,0,0,127429.085937500,0,423291.968750000,259552.656250000,99089.9296875000,277527.500000000,108703.414062500,0,0,159380.015625000,0,203158.968750000,0,247224.781250000,297360.875000000,279599.937500000,349283.937500000,110271.054687500,308968.156250000,420845.625000000,117869.375000000,193681.234375000,212892.312500000,81363.4453125000,276776.687500000,274061.750000000,465598.750000000,266085.187500000,0,204780.656250000,0,0,118542.921875000,181392.937500000,0,334102.031250000,0,0,272759.562500000,88736.4687500000,199538.375000000,275570.093750000,144470.093750000,0,216918.109375000,0,0,135349.125000000,352738.718750000,257176.281250000,237309.234375000,0,0,0,0,0,0,0,0,0,125783.687500000,0,0,0,126771.343750000,0,96013.4062500000,0,158007.500000000,193875.703125000,0,0,152252.578125000,0,199182.562500000,0,152121.656250000,0,415773.281250000,0,0,0,0,0,0,0,142376.718750000,186963.843750000,100922.687500000];
fluo_DELAY_5min = [211129.406250000,0,116020.820312500,125003.593750000,230341.562500000,0,100140.750000000,0,77140.0312500000,175568.546875000,162171.453125000,56201.0898437500,0,0,0,479913,151863.109375000,0,0,0,263768.937500000,0,0,167376.453125000,159872.187500000,281906.750000000,0,224442.625000000,361553.625000000,89883.8906250000,103177.125000000,0,0,0,0,268940.312500000,260713.437500000,316947.625000000,125662.070312500,192206.296875000,0,0,487520.625000000,0,169621.218750000,95762.4921875000,112539.250000000,246072.296875000,235593.171875000,90570.6171875000,518491.093750000,370771.906250000,453199.843750000,133485.296875000,269340.250000000,257426.140625000,54500.6914062500,392733.593750000,135496.015625000,353784.906250000,258006.546875000,0,326998.156250000,0,0,163651.265625000,160171.359375000,102369.828125000,169348.921875000,80384.4375000000,0,349833.343750000,75713.4140625000,182175.500000000,365405.312500000,0,65365.8398437500,147891,0,0,491926.781250000,324795.593750000,285373.906250000,325855.625000000,48681.1875000000,0,77486.9687500000,126742.203125000,0,120484.070312500,0,0,0,174013.468750000,0,0,0,67814.0390625000,0,229223.281250000,148042.687500000,151776.421875000,0,0,0,164144.562500000,0,78404.3906250000,0,116095.703125000,0,215166.156250000,0,0,0,0,0,0,0,167604.234375000,0,0];

fluo_ON_no_zero_4min = [105084.304687500,438922.937500000,499241.812500000,308694.718750000,175170.906250000,92561.6484375000,304872.906250000,251682.343750000,329968.562500000,397171.468750000,312080.750000000,223130.687500000,273446.656250000,243481.640625000,268748.062500000,247641.203125000,158609.234375000,338098.468750000,165603.750000000,74418.2500000000,163760.281250000,216311.703125000,78655.7500000000,225128.421875000,146429.265625000,420473.500000000,219699.171875000,481864.968750000,61373.8750000000,304339.562500000,250443.640625000,105205.179687500,262851.875000000,172141.953125000,190733.500000000,173889.875000000,224587.968750000,172655.781250000,188813.609375000,179913.234375000,413640.312500000,92713.5000000000,94860.0468750000,154613.968750000,549912.250000000,310763.625000000,237292.593750000,85653.2265625000,88819.5312500000,154819.656250000,114806.750000000,103150.726562500,111236.250000000,214153,71692.9687500000,102560.062500000,415607.718750000,200823.234375000,212369.390625000,207462.921875000,245440.890625000,158813.234375000,574831.812500000,213622.703125000,186444.250000000,85975.9218750000,105532.687500000,304895.718750000,294880.562500000,156167.359375000,256532.906250000,107057.109375000,303234.250000000,135451.437500000,324196,104973.406250000,50269.5781250000,226860.546875000,91089.2187500000,141230.875000000,106948.265625000,201027.562500000,129942.125000000,403377.093750000,137485.687500000,273632.625000000,456527.031250000,63043.5468750000,236413.625000000,404427.062500000,363797,241747.250000000,135145.937500000,144360.328125000,354405.187500000,172924.453125000,518829.875000000,164641.562500000,104927.125000000,302364.187500000,184682.546875000,137325.375000000,343307.656250000,492670.875000000,77579.9140625000,148984.671875000,251673.296875000,229539.921875000,139853.218750000,190974.421875000,139112.156250000,277350.343750000,249948.281250000,133152.171875000,116429.687500000,226966.671875000,438429,140246.625000000,217084.562500000,265118.531250000,348529.718750000,121382.031250000,130676.109375000,180798.062500000,266223.593750000,79279.1953125000,290262.187500000,209770.921875000,496019.812500000,334596.781250000,164023.953125000,113665.585937500,166698.984375000,274865,64918.6054687500,174010.750000000,175376.796875000,628571.125000000,103625.703125000,83101.2500000000,306382.750000000,110234.187500000,118981.140625000,271653.218750000,69812.9140625000,304589.312500000,186946.687500000,193393.187500000,269405.125000000,116088.710937500,122547.960937500,69518.7968750000,86466.3125000000,162900.718750000,138609.593750000,259964.296875000,302093.593750000,98083.6796875000,374498.718750000,301514.562500000,265958.656250000,324024.968750000,93306.3593750000,97359.3828125000,364111.781250000,109729.226562500,310424.781250000,371370.093750000,126820.929687500,315776.437500000,159064.265625000,120919.765625000,80273.7734375000,132224.343750000,95027.7421875000,138602.437500000,129997.562500000,403091.750000000,141784.031250000,162821.500000000,558690.500000000,150369.234375000,151792.390625000,195401.281250000,282988.625000000,287748.906250000];
fluo_ON_no_zero_5min = [175167.625000000,390252.906250000,445406.875000000,300988.218750000,161669.250000000,137974.968750000,76658.2109375000,299592.968750000,193891.250000000,211696.406250000,381552.625000000,285275.156250000,156504.421875000,362912.156250000,117288.937500000,202615.421875000,131607.437500000,337261.750000000,260519.968750000,139416.875000000,223814.281250000,367308.406250000,101383.343750000,305192.218750000,174883.921875000,497060.218750000,464707.812500000,128810.765625000,89080.4375000000,199687.531250000,188514.265625000,85924.4453125000,234885.921875000,57560.5820312500,280503.406250000,118462.242187500,157904.328125000,73435.4453125000,257913.265625000,97295.3046875000,388480.656250000,136379.593750000,103295.437500000,212399.250000000,183132.953125000,528389.875000000,347973.656250000,197820.343750000,181651.062500000,461425.812500000,71210.4609375000,96911.4375000000,381038.093750000,142801.203125000,78206.8515625000,108731.875000000,559795.187500000,124863.398437500,250076.625000000,154293.171875000,56364.1914062500,87392.0859375000,181373.812500000,161682.890625000,194096.906250000,67129.2500000000,357435.093750000,120974.335937500,59500.0703125000,197408.937500000,170536.062500000,225183.328125000,249602.375000000,582771.437500000,150387.531250000,260027.343750000,463892,197920.203125000,259401.156250000,164993.859375000,251414.921875000,79670.1562500000,349508.656250000,152451.437500000,188159.718750000,107969.937500000,80491.7656250000,221793.468750000,306929.562500000,110384.859375000,146872.625000000,349491.562500000,186298.250000000,386606.375000000,157039.859375000,419915.906250000,277685.687500000,127660.187500000,121835.968750000,200719.671875000,76677.3437500000,224113.031250000,129466,98380.5781250000,182907.500000000,178771.218750000,229309.687500000,378960.343750000,243044.109375000,65263.9375000000,262112.171875000,213532.796875000,156287.859375000,263316,276568.281250000,366677.218750000,89816.9062500000,135127.437500000,216833.906250000,150294.250000000,78894.2500000000,85899.9218750000,114849.984375000,417784.750000000,59873.5742187500,468909.625000000,42626.8554687500,151334.328125000,207242.062500000,167475.375000000,228279.046875000,170155.062500000,385411.187500000,133907.484375000,255855.875000000,173778.281250000,103031.554687500,458699.281250000,402681.187500000,112005.437500000,100094.843750000,97026.0312500000,47927.7851562500,92446.1171875000,197828.359375000,149005.390625000,342768.937500000,138097.796875000,209136.531250000,123829.812500000,202131.687500000,90052.4140625000,65997.1250000000,69288.3437500000,249319.750000000,264918.468750000,118964.250000000,293891.468750000,246904.781250000,347965.843750000,205977.687500000,104754.734375000,267783.937500000,378154.687500000,438824.281250000,325193.906250000,325562.093750000,133829.546875000,116134.593750000,246508.375000000,481388.750000000,317959.750000000,283828.562500000,133759.187500000,126894.062500000,402819.843750000,182683.437500000,319888.843750000,126616.187500000,118924.562500000,311670.750000000,307988.281250000];
fluo_ON_4min = [105084.304687500,438922.937500000,499241.812500000,308694.718750000,0,175170.906250000,92561.6484375000,304872.906250000,251682.343750000,329968.562500000,397171.468750000,312080.750000000,223130.687500000,273446.656250000,243481.640625000,268748.062500000,247641.203125000,0,158609.234375000,338098.468750000,165603.750000000,74418.2500000000,0,163760.281250000,216311.703125000,78655.7500000000,225128.421875000,146429.265625000,0,420473.500000000,219699.171875000,481864.968750000,0,61373.8750000000,304339.562500000,250443.640625000,105205.179687500,262851.875000000,172141.953125000,190733.500000000,0,0,173889.875000000,224587.968750000,172655.781250000,188813.609375000,0,179913.234375000,413640.312500000,92713.5000000000,94860.0468750000,154613.968750000,549912.250000000,310763.625000000,237292.593750000,85653.2265625000,88819.5312500000,154819.656250000,114806.750000000,103150.726562500,111236.250000000,214153,0,71692.9687500000,102560.062500000,415607.718750000,200823.234375000,212369.390625000,207462.921875000,0,0,245440.890625000,158813.234375000,574831.812500000,213622.703125000,186444.250000000,0,85975.9218750000,0,105532.687500000,0,304895.718750000,294880.562500000,156167.359375000,0,256532.906250000,107057.109375000,303234.250000000,135451.437500000,324196,104973.406250000,50269.5781250000,226860.546875000,91089.2187500000,141230.875000000,0,0,0,0,106948.265625000,201027.562500000,129942.125000000,403377.093750000,137485.687500000,0,273632.625000000,456527.031250000,0,63043.5468750000,236413.625000000,0,404427.062500000,363797,241747.250000000,135145.937500000,144360.328125000,354405.187500000,172924.453125000,518829.875000000,164641.562500000,104927.125000000,0,0,302364.187500000,0,184682.546875000,137325.375000000,0,343307.656250000,492670.875000000,0,77579.9140625000,148984.671875000,251673.296875000,0,229539.921875000,139853.218750000,190974.421875000,139112.156250000,0,277350.343750000,249948.281250000,133152.171875000,116429.687500000,226966.671875000,438429,140246.625000000,217084.562500000,265118.531250000,348529.718750000,121382.031250000,130676.109375000,180798.062500000,266223.593750000,79279.1953125000,290262.187500000,0,0,0,209770.921875000,496019.812500000,334596.781250000,164023.953125000,113665.585937500,166698.984375000,274865,64918.6054687500,174010.750000000,175376.796875000,628571.125000000,103625.703125000,83101.2500000000,306382.750000000,110234.187500000,118981.140625000,271653.218750000,69812.9140625000,304589.312500000,0,186946.687500000,193393.187500000,0,0,269405.125000000,116088.710937500,0,122547.960937500,69518.7968750000,86466.3125000000,162900.718750000,0,138609.593750000,259964.296875000,0,0,302093.593750000,0,0,98083.6796875000,374498.718750000,301514.562500000,265958.656250000,324024.968750000,93306.3593750000,97359.3828125000,364111.781250000,0,109729.226562500,310424.781250000,371370.093750000,126820.929687500,315776.437500000,159064.265625000,120919.765625000,80273.7734375000,132224.343750000,95027.7421875000,138602.437500000,129997.562500000,403091.750000000,141784.031250000,162821.500000000,558690.500000000,150369.234375000,151792.390625000,0,195401.281250000,282988.625000000,287748.906250000];
fluo_ON_5min = [175167.625000000,390252.906250000,445406.875000000,300988.218750000,0,161669.250000000,137974.968750000,76658.2109375000,299592.968750000,193891.250000000,211696.406250000,381552.625000000,285275.156250000,156504.421875000,362912.156250000,117288.937500000,202615.421875000,0,131607.437500000,337261.750000000,260519.968750000,0,139416.875000000,223814.281250000,367308.406250000,101383.343750000,305192.218750000,174883.921875000,0,497060.218750000,464707.812500000,128810.765625000,89080.4375000000,0,199687.531250000,188514.265625000,85924.4453125000,234885.921875000,57560.5820312500,280503.406250000,0,0,118462.242187500,157904.328125000,73435.4453125000,257913.265625000,97295.3046875000,388480.656250000,136379.593750000,103295.437500000,0,212399.250000000,183132.953125000,528389.875000000,347973.656250000,197820.343750000,181651.062500000,461425.812500000,71210.4609375000,96911.4375000000,381038.093750000,142801.203125000,0,78206.8515625000,108731.875000000,559795.187500000,124863.398437500,250076.625000000,154293.171875000,0,0,56364.1914062500,87392.0859375000,181373.812500000,161682.890625000,194096.906250000,67129.2500000000,0,0,357435.093750000,0,120974.335937500,59500.0703125000,197408.937500000,0,170536.062500000,225183.328125000,249602.375000000,582771.437500000,150387.531250000,260027.343750000,0,463892,197920.203125000,259401.156250000,0,164993.859375000,0,0,0,251414.921875000,79670.1562500000,349508.656250000,152451.437500000,0,188159.718750000,107969.937500000,0,80491.7656250000,221793.468750000,0,306929.562500000,110384.859375000,146872.625000000,349491.562500000,186298.250000000,386606.375000000,157039.859375000,419915.906250000,277685.687500000,0,0,127660.187500000,121835.968750000,0,200719.671875000,0,76677.3437500000,224113.031250000,129466,0,98380.5781250000,182907.500000000,178771.218750000,0,229309.687500000,378960.343750000,243044.109375000,65263.9375000000,0,262112.171875000,213532.796875000,156287.859375000,263316,276568.281250000,366677.218750000,89816.9062500000,135127.437500000,216833.906250000,150294.250000000,78894.2500000000,85899.9218750000,114849.984375000,417784.750000000,59873.5742187500,468909.625000000,0,42626.8554687500,151334.328125000,207242.062500000,167475.375000000,228279.046875000,170155.062500000,385411.187500000,133907.484375000,255855.875000000,173778.281250000,103031.554687500,458699.281250000,402681.187500000,0,112005.437500000,100094.843750000,97026.0312500000,47927.7851562500,92446.1171875000,0,197828.359375000,0,149005.390625000,342768.937500000,0,138097.796875000,209136.531250000,123829.812500000,0,202131.687500000,90052.4140625000,0,65997.1250000000,0,69288.3437500000,249319.750000000,0,0,264918.468750000,0,118964.250000000,293891.468750000,246904.781250000,347965.843750000,205977.687500000,104754.734375000,267783.937500000,0,378154.687500000,0,438824.281250000,325193.906250000,325562.093750000,133829.546875000,116134.593750000,246508.375000000,481388.750000000,0,317959.750000000,0,283828.562500000,133759.187500000,126894.062500000,402819.843750000,0,182683.437500000,319888.843750000,126616.187500000,0,118924.562500000,311670.750000000,307988.281250000];

response_time_DELAY = [3.32531925333328,4.65549991253335,3.32531925333328,3.65793061546671,3.99027718826668,5.98541578239995,4.65549991253335,2.99270789119999,3.65793061546671,4.98784648533331,1.99513859413327,2.66036131840000,2.66036131840000,5.98541578239995,2.99270789119999,2.99270789119999,9.08391466666665,2.32774995626659,3.99027718826668,8.08634536959998,1.66279202133331,1.66279202133331,2.66036131840000,2.32774995626659,3.99027718826668,2.99270789119999,1.99513859413327,0.997834086399994,5.65280442026663,3.99027718826668,5.32045784746664,2.66036131840000,3.65793061546671,2.99270789119999,0.997834086399994,6.31802714453327,7.08877607253335,2.32774995626659,6.31802714453327,1.99513859413327,4.32288855040000,2.32774995626659,3.99027718826668,1.99513859413327,0.332611362133353,1.33018065919996,2.66036131840000,2.99270789119999,2.99270789119999,1.66279202133331,2.66036131840000,2.32774995626659,2.99270789119999,8.31316573866663,4.32288855039999,3.99027718826664,3.32531925333335,3.65766582613332,4.98784648533328,5.98541578239995,3.65766582613332,2.99270789120000,2.99270789120000,4.98784648533328,3.32531925333335,5.65306920960002,2.99270789120000,1.99540338346665,2.66036131840003,0.665222724266638,1.33018065920001,6.98298507946668,3.65766582613332,4.98784648533328,1.99540338346665,4.32288855039999,4.32288855039999,10.6406509056000,2.32774995626671,3.65766582613332,2.66036131840003,3.65766582613332,3.99027718826664,4.98784648533328,2.66036131840003,2.66036131840003,7.31559644160000,5.65306920960002,2.66036131840003,3.99027718826664,6.65063850666671,1.33018065920001,8.64551231146663,2.66036131840003,6.65063850666671,5.32045784746667,5.98541578239995,1.99540338346665,5.65306920960002,1.99540338346665,3.99027718826664,3.99027718826664,2.99270789120000];
response_time_ON = [2.99270789120002,1.99513859413338,1.33018065920001,1.99513859413338,1.33018065920001,1.66279202133333,1.33018065920001,2.32774995626670,0.997569297066685,2.99270789120002,2.66009652906670,3.32531925333334,11.0654374741333,1.66279202133333,3.65766582613335,0.664957934933364,3.65766582613335,2.99270789120002,11.3977840469333,0.664957934933364,0.997569297066685,2.32774995626670,2.32774995626670,0.332611362133321,2.32774995626670,3.32531925333334,2.99270789120002,11.3977840469333,1.66279202133333,2.66009652906670,1.99513859413338,2.32774995626670,2.66009652906670,1.66279202133333,1.99513859413338,1.99513859413338,0.664957934933364,0.997569297066685,0.332611362133321,3.65766582613335,2.99297268053331,2.66036131839998,1.66279202133334,0.997834086399973,5.65306920959997,1.99540338346666,2.99297268053331,4.32315333973333,3.99054197760000,1.99540338346666,1.99540338346666,11.5064472917333,2.99297268053331,3.32558404266663,0.665487513599993,2.32801474560001,1.99540338346666,7.31586123093330,1.66279202133334,1.33018065919997,0.997834086399973,1.33018065919997,2.66036131839998,6.65063850666665,0.332876151466667,2.99297268053331,0.332611362133328,1.99513859413334,1.33018065920002,1.66252723200002,5.32045784746662,2.99270789119996,3.32531925333328,1.99513859413334,4.65523512319998,2.66009652906664,1.66252723200002,5.98541578240002,2.32774995626666,1.99513859413334,1.99513859413334,7.98055437653334,0.997569297066622,2.66009652906664,2.32774995626666,1.99513859413334,2.66009652906664,1.99513859413334,1.99513859413334,1.66252723200002,1.66252723200002,2.66009652906664,1.66252723200002,1.99513859413334,6.31802714453334,4.98784648533330,4.32262376106664,1.66252723200002,2.99270789119996,2.66009652906664,2.66009652906664,1.66252723200002,2.66009652906664,2.99270789119996,1.66252723200002,2.99270789120007,2.99270789120007,2.32774995626666,3.32505446400003,2.99270789120007,2.99270789120007,1.99487380479999,2.32774995626666,3.32505446400003,2.66009652906675,3.99027718826667,1.32991586986670,2.66009652906675,1.32991586986670,4.32262376106665,5.32019305813337,2.32774995626666,3.32505446400003,1.66252723200002,3.65766582613336,2.32774995626666,1.32991586986670,3.65766582613336,1.99487380479999,1.99487380479999,1.99487380479999,1.99487380479999,1.32991586986670,1.32991586986670,3.65766582613336,0.997569297066733,0.664957934933412,3.65766582613336,1.99487380479999,1.99487380479999,1.32991586986670,2.32774995626666,1.32991586986670];


%% plot fluo mean for reactivated nuclei

edges_mean_fluo = linspace(0,7E5,20);

figure_react_fluo = figure;
hold on

a = fluo_ON_no_zero_4min;
b = fluo_DELAY_no_zero_4min;

h = histogram(a,edges_mean_fluo,'Normalization','probability');
h = histogram(b,edges_mean_fluo,'Normalization','probability');

[h,p] = kstest2(a,b)

data_fluo = [a b];
cat_fluo = [ones(1,length(a)) 2*ones(1,length(b))];


violin_plot = figure;
%vs1 = violinplot(data_fluo,cat_fluo,'BandWidth',3E4,'ShowData',true,'ShowNotches',false);
vs1 = violinplot(data_fluo,cat_fluo,'ShowData',true,'ShowNotches',false);

%ylim([0 analysis_range_ON])
ylabel('mean fluorescence after reactivation (AU)')
pbaspect([3 4 1])

%% plot fluo mean for all nuclei

edges_mean_fluo = linspace(0,7E5,20);

figure_react_fluo = figure;
hold on

a = fluo_ON_4min;
b = fluo_DELAY_4min;

h = histogram(a,edges_mean_fluo,'Normalization','probability');
h = histogram(b,edges_mean_fluo,'Normalization','probability');

[h,p] = kstest2(a,b)

data_fluo = [a b];
cat_fluo = [ones(1,length(a)) 2*ones(1,length(b))];

%data_fluo = [fluo_react_4min fluo_react_2min];
%cat_fluo = [ones(1,length(fluo_react_4min)) 2*ones(1,length(fluo_react_2min))];

violin_plot = figure;
%vs1 = violinplot(data_fluo,cat_fluo,'BandWidth',3E4,'ShowData',true,'ShowNotches',false);
vs1 = violinplot(data_fluo,cat_fluo,'ShowData',true,'ShowNotches',false);

%ylim([0 analysis_range_ON])
ylabel('mean fluorescence after reactivation (AU)')
pbaspect([3 2 1])

%% plot response time
edges_time = linspace(0,8,15);

a = response_time_ON(response_time_ON<=10);
b = response_time_DELAY(response_time_DELAY<=10);

hist_fig = figure;
hold on
h = histogram(a,edges_time,'Normalization','probability');
h = histogram(b,edges_time,'Normalization','probability');

[h,p] = kstest2(a,b)

data_fluo = [a b];
cat_fluo = [ones(1,length(a)) 2*ones(1,length(b))];

violin_plot = figure;
%vs1 = violinplot(data_fluo,cat_fluo,'BandWidth',3E4,'ShowData',true,'ShowNotches',false);
vs1 = violinplot(data_fluo,cat_fluo,'ShowData',true,'ShowNotches',false);

%ylim([0 analysis_range_ON])
ylabel('mean fluorescence after reactivation (AU)')
pbaspect([3 2 1])



